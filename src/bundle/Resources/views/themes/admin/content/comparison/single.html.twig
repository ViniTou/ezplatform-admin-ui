{% extends '@ezdesign/ui/layout.html.twig' %}

{% block navigation %}
{% endblock %}

{% block content %}
<div style="display: flex; flex-direction: column">
    <div class="ez-content-preview-menu">
        {{ form_start(select_versions_form) }}
        {{ form_widget(select_versions_form.version_a, { 'attr': {'class' : 'left' }}) }}
        {{ form_widget(select_versions_form.side_by_side, { 'attr': {'class' : 'left' }}) }}
        {{ form_widget(select_versions_form.compare, { 'attr': {'class' : 'left', 'disabled' : 'disabled'}}) }}
        {{ form_widget(select_versions_form.version_b, { 'attr': {'class' : 'left' }}) }}
        {{ form_end(select_versions_form) }}
    </div>
    <div class="ez-content-preview comparison-preview" data-content-id={{ content_a.id }}>
        {% for group in field_definitions_by_group %}
            {% if group.fieldValueDiff|length > 0 %}
                <section class="ez-fieldgroup container">
                    <h3 class="ez-fieldgroup__name">{{ group.name|capitalize }}</h3>
                    {% for field_diff in group.fieldValueDiff %}
                        {% block field_diff %}
                            <div class="ez-content-field">
                                <p class="ez-content-field-name">{{ field_diff.getFieldDefinition.name }}:</p>
                                <div class="ez-content-field-value">
                                    {% if not field_diff.isChanged() %}
                                        {{ ez_render_field(content_a, field_diff.getFieldDefinition.identifier, {
                                            'template': '@ezdesign/ui/field_type/preview/content_fields.html.twig'
                                        }) }}
                                    {% else %}
                                        {{ ez_render_comparison_result(field_diff.getFieldDefinition, field_diff.getComparisonResult, {
                                        }) }}
                                    {% endif %}
                                </div>
                            </div>
                        {% endblock %}
                    {% endfor %}
                </section>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('ezplatform-admin-ui-version-comparison-js', null, 'ezplatform') }}
{% endblock %}
